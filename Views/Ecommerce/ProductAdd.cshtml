@{
    ViewData["Title"] = "Add Product - eCommerce";
}

@section VendorStyles {
    <link rel="stylesheet" href="~/vendor/libs/dropzone/dropzone.css" />
    <link rel="stylesheet" href="~/vendor/libs/select2/select2.css" />
    <link rel="stylesheet" href="~/vendor/libs/toastr/toastr.css" />
}

@section VendorScripts {
    <script src="~/vendor/libs/dropzone/dropzone.js"></script>
    <script src="~/vendor/libs/select2/select2.js"></script>
    <script src="~/vendor/libs/toastr/toastr.js"></script>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
}

<script>
    // Pass Firebase configuration from server to client
    const firebaseConfig = {
        apiKey: "@ViewBag.FirebaseApiKey",
        authDomain: "@ViewBag.FirebaseProjectId" + ".firebaseapp.com",
        projectId: "@ViewBag.FirebaseProjectId",
        storageBucket: "@ViewBag.FirebaseStorageBucket",
        messagingSenderId: "@ViewBag.FirebaseMessagingSenderId",
        appId: "@ViewBag.FirebaseAppId"
    };

    // For debugging
    console.log("Firebase config:", firebaseConfig);
</script>
<script src="~/js/app-ecommerce-product-add.js"></script>

<div class="app-ecommerce">
    <form id="productForm" method="post">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title">Product Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label" for="Name">Name</label>
                        <input type="text" class="form-control" id="Name" name="Name" required />
                        <div class="invalid-feedback">Please enter a product name</div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label" for="SKU">SKU</label>
                        <input type="text" class="form-control" id="SKU" name="SKU" />
                        <div class="invalid-feedback">Please enter a valid SKU</div>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label" for="Description">Description</label>
                    <textarea class="form-control" id="Description" name="Description" rows="4"></textarea>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label" for="Price">Price</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" class="form-control" id="Price" name="Price" step="0.01" required />
                            <div class="invalid-feedback">Please enter a valid price</div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label" for="Stock">Stock</label>
                        <input type="number" class="form-control" id="Stock" name="Stock" required />
                        <div class="invalid-feedback">Please enter a valid stock quantity</div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label" for="Discount">Discount (%)</label>
                        <input type="number" class="form-control" id="Discount" name="Discount" min="0" max="100" value="0" />
                        <div class="invalid-feedback">Please enter a valid discount (0-100)</div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label" for="BrandId">Brand</label>
                        <select class="form-select select2" id="BrandId" name="BrandId" required>
                            <option value="">Select Brand</option>
                            <!-- Brands will be populated dynamically -->
                        </select>
                        <div class="invalid-feedback">Please select a brand</div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label" for="CategoryId">Category</label>
                        <select class="form-select select2" id="CategoryId" name="CategoryId" required>
                            <option value="">Select Category</option>
                            <!-- Categories will be populated dynamically -->
                        </select>
                        <div class="invalid-feedback">Please select a category</div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label" for="Commission">Commission (%)</label>
                        <input type="number" class="form-control" id="Commission" name="Commission" min="0" max="100" value="30" />
                        <div class="invalid-feedback">Please enter a valid commission (0-100)</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title">Product Images</h5>
                <small class="text-muted">Images will be stored in folders based on brand and category</small>
            </div>
            <div class="card-body">
                <div class="dropzone" id="productImages"></div>
                <input type="hidden" id="imagesJson" name="imagesJson" />
                <div class="mt-2">
                    <small class="text-muted">Supported formats: JPG, PNG, GIF. Maximum file size: 5MB.</small>
                </div>
            </div>
        </div>

        <div class="text-end mb-4">
            <a href="/Ecommerce/ProductList" class="btn btn-outline-secondary me-2">Cancel</a>
            <button type="submit" class="btn btn-primary" id="saveProductBtn">Save Product</button>
        </div>
    </form>
</div>



